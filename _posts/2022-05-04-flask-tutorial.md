---
layout: post
title: Flask Tutorial
author: john_doe
date: 2022-05-01 11:11:59
---
Flask is a Python-based  web framework and relies on Jinja2 template engine and Werkzeug WSGI. WSGI : Web Server Gateway Interface (WEB Service Gateway Interface), defines the interface format between web app and web server written in python

### Install flask

To intsall flask, just use pip.

```
sudo pip3 install flask
```

Check flask version
Enter python3 interactive mode.

```python
>>>import flask
>>>flask.__version__
```

Note: There will be slight differences between versions, try to focus on the teaching environment

### Initialize the flask application

A basic Flask application is shown below

```python
from flask import Flask
# Build the currently running main application as a Flask application to receive user requests and give responses
app = Flask(__name__)
     
@app.route('/')
def index():
    return "<h1>this is my first flask app</h1>"
       
# Run the Flask app
if __name__ == '__main__':
    app.run(debug=True)
```

*@app.route():* route definition in Flask, defines the user's access path, / represents the root path of the whole site

*def index():* @app.route() path after the handler-view function, the function must have return, return to a string or response object

After running the application, it will start the small server that comes with flask, the default port number to open locally is 5000

*debug=True*, is to change the current startup mode to debug mode (debug mode is recommended in development environment, not allowed in production environment)

![](/assets/img/uploads/python-flask.png)

### Flask-route

#### What is routing

The client sends the request to the web server, which in turn sends the request to the flask instance

The application instance needs to know which code to run for each url request, so it needs to create a mapping from the url to the python function

Routing is the procedure that handles the relationship between the url and the python function. In Flask, routing is represented by the @app.route decorator

#### Usage of Routing

Basic usage

```python
@app.route('/')
def index():
    return 'This is index page.'
     
@app.route('/login')
def login():
    return 'This is login page.'
```
<br />

#### Routing with parameters

Basic routing with parameters

```python
    @app.route('/show/<name>')
    def show1(name):
        # In the function, name is the data passed in the address bar
        return 'xxx'
```

Routing with multiple parameters

```python
@app.route('/show2/<name>/<age>')
def show1(name,age):
    # In the function, name is the data passed in the address bar
    return 'xxx'
```

Specify the route for the parameter type

```python
@app.route('/show3/<name>/<int:age>')
def show1(name,age):
    # In the function, name is the data passed in the address bar
    return 'xxx'
```
<br />

#### Route matching for multiple URLs

Allows to set multiple url routing rules in one view handler

```python
@app.route('/')
@app.route('/index')
def index():
    return "xxx"
```
<br />

#### Setting HTTP request methods in routing

Flask routing rules also allow setting the corresponding request method, and only the path matching the request method will be given to the view handler for execution
If no request method is specified, GET requests are allowed by default

```python
#Only the post request method is allowed to access localhost:5000/post
@app.route('/post',methods=['POST'])
def post():
    return 'xxxx'
```
<br />

#### Reverse Parsing

Forward parsing: The program automatically parses the access path in @app.route() to match the handler function.

Reverse parsing: the access path of the view handler is automatically generated by the name of the view handler

Flask provides url_for() function to reverse parse the url

```python
@app.route('/')
def index():
     return "Index"

@app.route('/show/<name>')
def show(name):
    return "name:%s" % name
```

url_for('index') : the result is : /
url_for('show',name='qtx') : The result is : /show/qtx

<br />

### Flask models

It uses the MVC and MTV frameworks. So what are these?

#### MVC pattern

* M : Models , the model layer , responsible for database modeling
* V : Views, the view layer, used to handle the content displayed by the user, such as :html
* C : Controller, controller, handle the part of the user interaction. Handles user 
  requests and gives responses

<br />

#### MTV pattern

* M : Models, the model layer, is responsible for database modeling
* T : Templates, the template layer, which handles the content displayed by the user, e.g., html
* V : Views, the view layer, handles the part of the content that interacts with the user. Handles user requests and gives responses

<br />

### Flask templates

#### What is Template

Template is a file containing response text (usually html file)

Templates are allowed to contain "placeholder variables" to represent dynamic content, and the "placeholder variables" will eventually be replaced by real values.

The template is also eventually parsed into a response string, a process called "rendering".

#### Default template directory

By default, Flask will look for templates in the templates subfolder of the application folder

Note: You need to create templates folder manually

#### Customize the template file directory

You can modify the configuration to specify a filename string for the template_folder property

```python
app = Flask(__name__,template_folder='templates') # Configure the folder for template files
```

#### Template syntax

The syntax of templates is html mixed with code:

{% raw %}

```python
placeholder variables {{ variable name }}
comment {# content to comment #}
tag {% tag name %}
{% end tag (end+tag name) %}

{% if condition %}
{% elif condition 2 %}
{% else %}
{% endif %}

{% for variable name in iterable object %}
{% endfor %}
```

{% endraw %}